/*
시간 제한	메모리 제한	제출	정답	맞힌 사람	정답 비율
1 초	256 MB	68337	19752	13154	28.367%
문제
히스토그램은 직사각형 여러 개가 아래쪽으로 정렬되어 있는 도형이다. 
각 직사각형은 같은 너비를 가지고 있지만, 높이는 서로 다를 수도 있다. 
예를 들어, 왼쪽 그림은 높이가 2, 1, 4, 5, 1, 3, 3이고 너비가 1인 직사각형으로 이루어진 히스토그램이다.

히스토그램에서 가장 넓이가 큰 직사각형을 구하는 프로그램을 작성하시오.

입력
입력은 테스트 케이스 여러 개로 이루어져 있다. 
각 테스트 케이스는 한 줄로 이루어져 있고, 직사각형의 수 n이 가장 처음으로 주어진다. (1 ≤ n ≤ 100,000) 
그 다음 n개의 정수 h1, ..., hn (0 ≤ hi ≤ 1,000,000,000)가 주어진다. 
이 숫자들은 히스토그램에 있는 직사각형의 높이이며, 왼쪽부터 오른쪽까지 순서대로 주어진다. 
모든 직사각형의 너비는 1이고, 입력의 마지막 줄에는 0이 하나 주어진다.

출력
각 테스트 케이스에 대해서, 히스토그램에서 가장 넓이가 큰 직사각형의 넓이를 출력한다.

1. 히스토그램을 반으로 나눴을 때, 직사각형이 있는 케이스는
    ㄴ 왼쪽에 있을 때, 오른쪽에 있을 때, 경계에 걸쳐있을 때 3종류
따라서 재귀로 좌, 우측에 있는 경우의 직사각형과, 경계에 걸친 직사각형 중 최대값을 구한다.
*/

#include <iostream>
#include <vector>
using namespace std;

vector<long long> h;

long long Solve(int left, int right){
    if(left >= right) return h[left];

    int mid = (left + right) / 2;
    long long res = max(Solve(left, mid), Solve(mid + 1, right));

    int low = mid, high = mid + 1;
    long long height = min(h[low], h[high]);
    res = max(res, height * 2);

    while(left < low || high < right){
        if(high < right && (low == left || h[low - 1] < h[high + 1])){
            high++;
            height = min(height, h[high]);
        }
        else{
            low--;
            height = min(height, h[low]);
        }
        res = max(res, height * (high - low + 1));
    }
    return res;
}

int main()
{
    ios::sync_with_stdio(false);
    cin.tie(nullptr);

    while(true){
        int n;
        cin >> n;
        if(n == 0) return 0;

        h.resize(n);

        for(int i = 0; i < n; ++i){
            cin >> h[i];
        }

        long long ans = Solve(0, n-1);

        cout << ans << "\n";
    }

    return 0;
}